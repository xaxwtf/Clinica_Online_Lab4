import{a as j,c as N,d as A,e as Ae,f as D,h as ee,i as z,j as Se,k as te}from"./chunk-CHWWAFAA.js";import{a as Ie}from"./chunk-VTBDDTBI.js";import{E as Ue,a as pe,b as Q,c as _e,d as me,e as ge,h as be,j as x,k as Re,o as Te,p as we,q as ye,r as Ee,s as ke,t as H,y as C}from"./chunk-AVWEISCT.js";import{V as q,Z as fe,_ as $,a as J,b as de,e as g}from"./chunk-XRRFT3FD.js";var ve="firebasestorage.googleapis.com",Be="storageBucket",at=120*1e3,ut=600*1e3;var l=class e extends be{constructor(t,s,n=0){super(ne(t),`Firebase Storage: ${s} (${ne(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,e.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return ne(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},d=(function(e){return e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment",e})(d||{});function ne(e){return"storage/"+e}function ue(){let e="An unknown error occurred, please check the error payload for server response.";return new l(d.UNKNOWN,e)}function ct(e){return new l(d.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function lt(e){return new l(d.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ht(){let e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new l(d.UNAUTHENTICATED,e)}function dt(){return new l(d.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function ft(e){return new l(d.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function pt(){return new l(d.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _t(){return new l(d.CANCELED,"User canceled the upload/download.")}function mt(e){return new l(d.INVALID_URL,"Invalid URL '"+e+"'.")}function gt(e){return new l(d.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function bt(){return new l(d.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Be+"' property when initializing the app?")}function Rt(){return new l(d.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Tt(){return new l(d.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function wt(e){return new l(d.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function se(e){return new l(d.INVALID_ARGUMENT,e)}function Le(){return new l(d.APP_DELETED,"The Firebase app was deleted.")}function yt(e){return new l(d.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function B(e,t){return new l(d.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function v(e){throw new l(d.INTERNAL_ERROR,"Internal error: "+e)}var R=class e{constructor(t,s){this.bucket=t,this.path_=s}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,s){let n;try{n=e.makeFromUrl(t,s)}catch{return new e(t,"")}if(n.path==="")return n;throw gt(t)}static makeFromUrl(t,s){let n=null,r="([A-Za-z0-9.\\-_]+)";function o(_){_.path.charAt(_.path.length-1)==="/"&&(_.path_=_.path_.slice(0,-1))}let i="(/(.*))?$",a=new RegExp("^gs://"+r+i,"i"),u={bucket:1,path:3};function c(_){_.path_=decodeURIComponent(_.path)}let h="v[A-Za-z0-9_]+",b=s.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",T=new RegExp(`^https?://${b}/${h}/b/${r}/o${m}`,"i"),w={bucket:1,path:3},k=s===ve?"(?:storage.googleapis.com|storage.cloud.google.com)":s,p="([^?#]*)",I=new RegExp(`^https?://${k}/${r}/${p}`,"i"),y=[{regex:a,indices:u,postModify:o},{regex:T,indices:w,postModify:c},{regex:I,indices:{bucket:1,path:2},postModify:c}];for(let _=0;_<y.length;_++){let M=y[_],Z=M.regex.exec(t);if(Z){let it=Z[M.indices.bucket],Y=Z[M.indices.path];Y||(Y=""),n=new e(it,Y),M.postModify(n);break}}if(n==null)throw mt(t);return n}},re=class{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}};function Et(e,t,s){let n=1,r=null,o=null,i=!1,a=0;function u(){return a===2}let c=!1;function h(...p){c||(c=!0,t.apply(null,p))}function b(p){r=setTimeout(()=>{r=null,e(T,u())},p)}function m(){o&&clearTimeout(o)}function T(p,...I){if(c){m();return}if(p){m(),h.call(null,p,...I);return}if(u()||i){m(),h.call(null,p,...I);return}n<64&&(n*=2);let y;a===1?(a=2,y=0):y=(n+Math.random())*1e3,b(y)}let w=!1;function k(p){w||(w=!0,m(),!c&&(r!==null?(p||(a=2),clearTimeout(r),b(0)):p||(a=1)))}return b(0),o=setTimeout(()=>{i=!0,k(!0)},s),k}function kt(e){e(!1)}function Ut(e){return e!==void 0}function It(e){return typeof e=="object"&&!Array.isArray(e)}function ce(e){return typeof e=="string"||e instanceof String}function Oe(e){return le()&&e instanceof Blob}function le(){return typeof Blob<"u"}function Pe(e,t,s,n){if(n<t)throw se(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>s)throw se(`Invalid value for '${e}'. Expected ${s} or less.`)}function he(e,t,s){let n=t;return s==null&&(n=`https://${t}`),`${s}://${n}/v0${e}`}function Fe(e){let t=encodeURIComponent,s="?";for(let n in e)if(e.hasOwnProperty(n)){let r=t(n)+"="+t(e[n]);s=s+r+"&"}return s=s.slice(0,-1),s}var O=(function(e){return e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT",e})(O||{});function At(e,t){let s=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,o=t.indexOf(e)!==-1;return s||r||o}var oe=class{constructor(t,s,n,r,o,i,a,u,c,h,b,m=!0,T=!1){this.url_=t,this.method_=s,this.headers_=n,this.body_=r,this.successCodes_=o,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=b,this.retry=m,this.isUsingEmulator=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,k)=>{this.resolve_=w,this.reject_=k,this.start_()})}start_(){let t=(n,r)=>{if(r){n(!1,new S(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let i=a=>{let u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&o.addUploadProgressListener(i),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(i),this.pendingConnection_=null;let a=o.getErrorCode()===O.NO_ERROR,u=o.getStatus();if(!a||At(u,this.additionalRetryCodes_)&&this.retry){let h=o.getErrorCode()===O.ABORT;n(!1,new S(!1,null,h));return}let c=this.successCodes_.indexOf(u)!==-1;n(!0,new S(c,o))})},s=(n,r)=>{let o=this.resolve_,i=this.reject_,a=r.connection;if(r.wasSuccessCode)try{let u=this.callback_(a,a.getResponse());Ut(u)?o(u):o()}catch(u){i(u)}else if(a!==null){let u=ue();u.serverResponse=a.getErrorText(),this.errorCallback_?i(this.errorCallback_(a,u)):i(u)}else if(r.canceled){let u=this.appDelete_?Le():_t();i(u)}else{let u=pt();i(u)}};this.canceled_?s(!1,new S(!1,null,!0)):this.backoffId_=Et(t,s,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&kt(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},S=class{constructor(t,s,n){this.wasSuccessCode=t,this.connection=s,this.canceled=!!n}};function St(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function Ot(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function Pt(e,t){t&&(e["X-Firebase-GMPID"]=t)}function xt(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function Ct(e,t,s,n,r,o,i=!0,a=!1){let u=Fe(e.urlParams),c=e.url+u,h=Object.assign({},e.headers);return Pt(h,t),St(h,s),Ot(h,o),xt(h,n),new oe(c,e.method,h,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,i,a)}function Nt(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Dt(...e){let t=Nt();if(t!==void 0){let s=new t;for(let n=0;n<e.length;n++)s.append(e[n]);return s.getBlob()}else{if(le())return new Blob(e);throw new l(d.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function vt(e,t,s){return e.webkitSlice?e.webkitSlice(t,s):e.mozSlice?e.mozSlice(t,s):e.slice?e.slice(t,s):null}function Bt(e){if(typeof atob>"u")throw wt("base-64");return atob(e)}var E={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},L=class{constructor(t,s){this.data=t,this.contentType=s||null}};function Lt(e,t){switch(e){case E.RAW:return new L(Me(t));case E.BASE64:case E.BASE64URL:return new L(qe(e,t));case E.DATA_URL:return new L(Mt(t),qt(t))}throw ue()}function Me(e){let t=[];for(let s=0;s<e.length;s++){let n=e.charCodeAt(s);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(s<e.length-1&&(e.charCodeAt(s+1)&64512)===56320))t.push(239,191,189);else{let o=n,i=e.charCodeAt(++s);n=65536|(o&1023)<<10|i&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function Ft(e){let t;try{t=decodeURIComponent(e)}catch{throw B(E.DATA_URL,"Malformed data URL.")}return Me(t)}function qe(e,t){switch(e){case E.BASE64:{let r=t.indexOf("-")!==-1,o=t.indexOf("_")!==-1;if(r||o)throw B(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case E.BASE64URL:{let r=t.indexOf("+")!==-1,o=t.indexOf("/")!==-1;if(r||o)throw B(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let s;try{s=Bt(t)}catch(r){throw r.message.includes("polyfill")?r:B(e,"Invalid character found")}let n=new Uint8Array(s.length);for(let r=0;r<s.length;r++)n[r]=s.charCodeAt(r);return n}var W=class{constructor(t){this.base64=!1,this.contentType=null;let s=t.match(/^data:([^,]+)?,/);if(s===null)throw B(E.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let n=s[1]||null;n!=null&&(this.base64=$t(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}};function Mt(e){let t=new W(e);return t.base64?qe(E.BASE64,t.rest):Ft(t.rest)}function qt(e){return new W(e).contentType}function $t(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}var V=class e{constructor(t,s){let n=0,r="";Oe(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(s?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(s?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(t,s){if(Oe(this.data_)){let n=this.data_,r=vt(n,t,s);return r===null?null:new e(r)}else{let n=new Uint8Array(this.data_.buffer,t,s-t);return new e(n,!0)}}static getBlob(...t){if(le()){let s=t.map(n=>n instanceof e?n.data_:n);return new e(Dt.apply(null,s))}else{let s=t.map(i=>ce(i)?Lt(E.RAW,i).data:i.data_),n=0;s.forEach(i=>{n+=i.byteLength});let r=new Uint8Array(n),o=0;return s.forEach(i=>{for(let a=0;a<i.length;a++)r[o++]=i[a]}),new e(r,!0)}}uploadData(){return this.data_}};function $e(e){let t;try{t=JSON.parse(e)}catch{return null}return It(t)?t:null}function Ht(e){if(e.length===0)return null;let t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function jt(e,t){let s=t.split("/").filter(n=>n.length>0).join("/");return e.length===0?s:e+"/"+s}function He(e){let t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}function zt(e,t){return t}var f=class{constructor(t,s,n,r){this.server=t,this.local=s||t,this.writable=!!n,this.xform=r||zt}},G=null;function Gt(e){return!ce(e)||e.length<2?e:He(e)}function je(){if(G)return G;let e=[];e.push(new f("bucket")),e.push(new f("generation")),e.push(new f("metageneration")),e.push(new f("name","fullPath",!0));function t(o,i){return Gt(i)}let s=new f("name");s.xform=t,e.push(s);function n(o,i){return i!==void 0?Number(i):i}let r=new f("size");return r.xform=n,e.push(r),e.push(new f("timeCreated")),e.push(new f("updated")),e.push(new f("md5Hash",null,!0)),e.push(new f("cacheControl",null,!0)),e.push(new f("contentDisposition",null,!0)),e.push(new f("contentEncoding",null,!0)),e.push(new f("contentLanguage",null,!0)),e.push(new f("contentType",null,!0)),e.push(new f("metadata","customMetadata",!0)),G=e,G}function Wt(e,t){function s(){let n=e.bucket,r=e.fullPath,o=new R(n,r);return t._makeStorageReference(o)}Object.defineProperty(e,"ref",{get:s})}function Vt(e,t,s){let n={};n.type="file";let r=s.length;for(let o=0;o<r;o++){let i=s[o];n[i.local]=i.xform(n,t[i.server])}return Wt(n,e),n}function ze(e,t,s){let n=$e(t);return n===null?null:Vt(e,n,s)}function Xt(e,t,s,n){let r=$e(t);if(r===null||!ce(r.downloadTokens))return null;let o=r.downloadTokens;if(o.length===0)return null;let i=encodeURIComponent;return o.split(",").map(c=>{let h=e.bucket,b=e.fullPath,m="/b/"+i(h)+"/o/"+i(b),T=he(m,s,n),w=Fe({alt:"media",token:c});return T+w})[0]}function Kt(e,t){let s={},n=t.length;for(let r=0;r<n;r++){let o=t[r];o.writable&&(s[o.server]=e[o.local])}return JSON.stringify(s)}var X=class{constructor(t,s,n,r){this.url=t,this.method=s,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Ge(e){if(!e)throw ue()}function Zt(e,t){function s(n,r){let o=ze(e,r,t);return Ge(o!==null),o}return s}function Yt(e,t){function s(n,r){let o=ze(e,r,t);return Ge(o!==null),Xt(o,r,e.host,e._protocol)}return s}function We(e){function t(s,n){let r;return s.getStatus()===401?s.getErrorText().includes("Firebase App Check token is invalid")?r=dt():r=ht():s.getStatus()===402?r=lt(e.bucket):s.getStatus()===403?r=ft(e.path):r=n,r.status=s.getStatus(),r.serverResponse=n.serverResponse,r}return t}function Jt(e){let t=We(e);function s(n,r){let o=t(n,r);return n.getStatus()===404&&(o=ct(e.path)),o.serverResponse=r.serverResponse,o}return s}function Qt(e,t,s){let n=t.fullServerUrl(),r=he(n,e.host,e._protocol),o="GET",i=e.maxOperationRetryTime,a=new X(r,o,Yt(e,s),i);return a.errorHandler=Jt(t),a}function en(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function tn(e,t,s){let n=Object.assign({},s);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=en(null,t)),n}function nn(e,t,s,n,r){let o=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let _=0;_<2;_++)y=y+Math.random().toString().slice(2);return y}let u=a();i["Content-Type"]="multipart/related; boundary="+u;let c=tn(t,n,r),h=Kt(c,s),b="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+c.contentType+`\r
\r
`,m=`\r
--`+u+"--",T=V.getBlob(b,n,m);if(T===null)throw Rt();let w={name:c.fullPath},k=he(o,e.host,e._protocol),p="POST",I=e.maxUploadRetryTime,U=new X(k,p,Zt(e,s),I);return U.urlParams=w,U.headers=i,U.body=T.uploadData(),U.errorHandler=We(t),U}var bn=256*1024;var xe=null,ie=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=O.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=O.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=O.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,s,n,r,o){if(this.sent_)throw v("cannot .send() more than once");if(Q(t)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(s,t,!0),o!==void 0)for(let i in o)o.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,o[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw v("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw v("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw v("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw v("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}},ae=class extends ie{initXhr(){this.xhr_.responseType="text"}};function Ve(){return xe?xe():new ae}var P=class e{constructor(t,s){this._service=t,s instanceof R?this._location=s:this._location=R.makeFromUrl(s,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,s){return new e(t,s)}get root(){let t=new R(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return He(this._location.path)}get storage(){return this._service}get parent(){let t=Ht(this._location.path);if(t===null)return null;let s=new R(this._location.bucket,t);return new e(this._service,s)}_throwIfRoot(t){if(this._location.path==="")throw yt(t)}};function sn(e,t,s){e._throwIfRoot("uploadBytes");let n=nn(e.storage,e._location,je(),new V(t,!0),s);return e.storage.makeRequestWithTokens(n,Ve).then(r=>({metadata:r,ref:e}))}function rn(e){e._throwIfRoot("getDownloadURL");let t=Qt(e.storage,e._location,je());return e.storage.makeRequestWithTokens(t,Ve).then(s=>{if(s===null)throw Tt();return s})}function on(e,t){let s=jt(e._location.path,t),n=new R(e._location.bucket,s);return new P(e.storage,n)}function an(e){return/^[A-Za-z]+:\/\//.test(e)}function un(e,t){return new P(e,t)}function Xe(e,t){if(e instanceof F){let s=e;if(s._bucket==null)throw bt();let n=new P(s,s._bucket);return t!=null?Xe(n,t):n}else return t!==void 0?on(e,t):e}function cn(e,t){if(t&&an(t)){if(e instanceof F)return un(e,t);throw se("To use ref(service, url), the first argument must be a Storage instance.")}else return Xe(e,t)}function Ce(e,t){let s=t?.[Be];return s==null?null:R.makeFromBucketSpec(s,e)}function ln(e,t,s,n={}){e.host=`${t}:${s}`;let r=Q(t);r&&(_e(`https://${e.host}/b`),ge("Storage",!0)),e._isUsingEmulator=!0,e._protocol=r?"https":"http";let{mockUserToken:o}=n;o&&(e._overrideAuthToken=typeof o=="string"?o:me(o,e.app.options.projectId))}var F=class{constructor(t,s,n,r,o,i=!1){this.app=t,this._authProvider=s,this._appCheckProvider=n,this._url=r,this._firebaseVersion=o,this._isUsingEmulator=i,this._bucket=null,this._host=ve,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=at,this._maxUploadRetryTime=ut,this._requests=new Set,r!=null?this._bucket=R.makeFromBucketSpec(r,this._host):this._bucket=Ce(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=R.makeFromBucketSpec(this._url,t):this._bucket=Ce(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Pe("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Pe("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){return g(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let t=this._authProvider.getImmediate({optional:!0});if(t){let s=yield t.getToken();if(s!==null)return s.accessToken}return null})}_getAppCheckToken(){return g(this,null,function*(){if(ye(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=this._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new P(this,t)}_makeRequest(t,s,n,r,o=!0){if(this._deleted)return new re(Le());{let i=Ct(t,this._appId,n,r,s,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}makeRequestWithTokens(t,s){return g(this,null,function*(){let[n,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,s,n,r).getPromise()})}},Ne="@firebase/storage",De="0.13.14";var Ke="storage";function Ze(e,t,s){return e=x(e),sn(e,t,s)}function Ye(e){return e=x(e),rn(e)}function Je(e,t){return e=x(e),cn(e,t)}function Qe(e=ke(),t){e=x(e);let n=we(e,Ke).getImmediate({identifier:t}),r=pe("storage");return r&&et(n,...r),n}function et(e,t,s,n={}){ln(e,t,s,n)}function hn(e,{instanceIdentifier:t}){let s=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new F(s,n,r,t,Ee)}function dn(){Te(new Re(Ke,hn,"PUBLIC").setMultipleInstances(!0)),H(Ne,De,""),H(Ne,De,"esm2017")}dn();var tt=C(Ye,!0);var nt=C(Qe,!0);var st=C(Je,!0,2);var rt=C(Ze,!0);var K=class e{constructor(t){this.firestore=t}cargarEspecialidades(){return g(this,null,function*(){let t=N(this.firestore,"Especialidades");return(yield D(t)).docs.map(n=>({id:n.id,nombre:n.data().nombre}))})}obtenerOcrearEspecialidad(t){return g(this,null,function*(){let s=t.trim().toLowerCase().replace(/\s+/g,"_"),n=A(this.firestore,`Especialidades/${s}`);return(yield Ae(n)).exists()||(yield z(n,{nombre:t})),s})}static \u0275fac=function(s){return new(s||e)(fe(j))};static \u0275prov=q({token:e,factory:e.\u0275fac,providedIn:"root"})};var ot=class e{auth=$(Ue);firestore=$(j);especialidadesService=$(K);constructor(){}register(t,s,n,r){return g(this,null,function*(){let o=yield Ie(this.auth,t,s);if(r&&r.length>0){let a=nt();Array.isArray(n.ImagenesDePerfil)?n.ImagenesDePerfil=n.ImagenesDePerfil.filter(u=>u!=null):n.ImagenesDePerfil=[];for(let u of r){let c=st(a,`usuarios/${o.user.uid}/${u.name}`);yield rt(c,u);let h=yield tt(c);h&&n.ImagenesDePerfil.push(h)}n.ImagenesDePerfil=n.ImagenesDePerfil.slice(0,2)}if("especialidad"in n&&typeof n.especialidad=="string"){let a=yield this.especialidadesService.obtenerOcrearEspecialidad(n.especialidad),u=A(this.firestore,`Especialidades/${a}`);n.especialidad=n.especialidad,n.especialidadRef=u}let i=de(J({},n),{ImagenesDePerfil:(n.ImagenesDePerfil||[]).filter(a=>a!=null),uid:o.user.uid,Email:o.user.email,creado:new Date});return yield z(A(this.firestore,"Usuarios",o.user.uid),i),o})}getUserLoged(){return g(this,null,function*(){let t=this.auth.currentUser;if(!t)return null;let s=ee(N(this.firestore,"Usuarios"),te("uid","==",t.uid)),n=yield D(s);return n.empty?null:n.docs[0].data()})}getUsuariosByCampo(t,s){return g(this,null,function*(){let n=ee(N(this.firestore,"Usuarios"),te(t,"==",s));return(yield D(n)).docs.map(o=>J({uid:o.id},o.data()))})}actualizarEstadoEspecialista(t,s){return g(this,null,function*(){let n=A(this.firestore,"Usuarios",t);yield Se(n,{activo:s})})}static \u0275fac=function(s){return new(s||e)};static \u0275prov=q({token:e,factory:e.\u0275fac,providedIn:"root"})};export{K as a,ot as b};
